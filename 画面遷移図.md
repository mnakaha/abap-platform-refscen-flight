# ABAP Platform Flight Reference Scenario - 画面遷移図

## 概要
このドキュメントは、ABAP Platform Flight Reference Scenarioの画面遷移とナビゲーション構造を説明します。

## システム構成
本システムは以下の3つの主要なシナリオで構成されています：

1. **Draft シナリオ** - ドラフト機能付き旅行管理
2. **Managed シナリオ** - 管理された旅行管理
3. **Unmanaged シナリオ** - 非管理旅行管理

## 画面遷移図

### 1. Draft シナリオ (/DMO/UI_TRAVEL_A_D)

```mermaid
graph TD
    A[旅行一覧画面<br/>Travel List] --> B[旅行詳細画面<br/>Travel Detail]
    B --> C[予約詳細画面<br/>Booking Detail]
    C --> D[予約追加サービス詳細<br/>Booking Supplement Detail]
    
    B --> E[旅行承認<br/>Accept Travel]
    B --> F[旅行却下<br/>Reject Travel]
    B --> G[割引適用<br/>Deduct Discount]
    
    A --> H[新規旅行作成<br/>Create Travel]
    B --> I[旅行編集<br/>Edit Travel]
    C --> J[新規予約作成<br/>Create Booking]
    D --> K[新規追加サービス作成<br/>Create Supplement]
    
    subgraph "バリューヘルプ"
        VH1[旅行代理店<br/>Travel Agency]
        VH2[顧客<br/>Customer]
        VH3[航空会社<br/>Airline]
        VH4[フライト<br/>Flight]
        VH5[空港<br/>Airport]
        VH6[通貨<br/>Currency]
        VH7[国<br/>Country]
        VH8[追加サービス<br/>Supplement]
    end
    
    B -.-> VH1
    B -.-> VH2
    C -.-> VH3
    C -.-> VH4
    C -.-> VH5
    B -.-> VH6
    B -.-> VH7
    D -.-> VH8
```

### 2. Managed シナリオ (/DMO/UI_TRAVEL_Processor_M)

```mermaid
graph TD
    A[旅行処理一覧<br/>Travel Processor List] --> B[旅行処理詳細<br/>Travel Processor Detail]
    B --> C[予約処理詳細<br/>Booking Processor Detail]
    C --> D[予約追加サービス処理<br/>BookingSupplement Processor Detail]
    
    B --> E[旅行コピー<br/>Copy Travel]
    
    A --> F[新規旅行作成<br/>Create Travel]
    B --> G[旅行編集<br/>Edit Travel]
    C --> H[新規予約作成<br/>Create Booking]
    D --> I[新規追加サービス作成<br/>Create Supplement]
    
    subgraph "検索・フィルタ"
        S1[旅行ID検索<br/>Travel ID Search]
        S2[代理店検索<br/>Agency Search]
        S3[顧客検索<br/>Customer Search]
        S4[ステータス検索<br/>Status Search]
    end
    
    A --> S1
    A --> S2
    A --> S3
    A --> S4
```

### 3. Unmanaged シナリオ (/DMO/TRAVEL_U)

```mermaid
graph TD
    A[旅行管理一覧<br/>Travel Management List] --> B[旅行管理詳細<br/>Travel Management Detail]
    B --> C[予約管理詳細<br/>Booking Management Detail]
    C --> D[予約追加サービス管理<br/>BookingSupplement Management Detail]
    
    B --> E[予約済みに設定<br/>Set to Booked]
    
    A --> F[新規旅行作成<br/>Create Travel]
    B --> G[旅行編集<br/>Edit Travel]
    C --> H[新規予約作成<br/>Create Booking]
    D --> I[新規追加サービス作成<br/>Create Supplement]
```

### 4. 代理店管理 (/DMO/UI_AGENCY)

```mermaid
graph TD
    A[代理店一覧<br/>Agency List] --> B[代理店詳細<br/>Agency Detail]
    B --> C[代理店レビュー<br/>Agency Review]
    
    A --> D[新規代理店作成<br/>Create Agency]
    B --> E[代理店編集<br/>Edit Agency]
    C --> F[新規レビュー作成<br/>Create Review]
    
    subgraph "拡張機能"
        EXT1[国別拡張<br/>Country Extension]
        EXT2[スローガン拡張<br/>Slogan Extension]
        EXT3[レビュー平均<br/>Review Average]
        EXT4[レビュー連絡先<br/>Review Contact]
    end
    
    B --> EXT1
    B --> EXT2
    C --> EXT3
    C --> EXT4
```

### 5. 航空会社管理 (/DMO/UI_CARRIERS_S)

```mermaid
graph TD
    A[航空会社一覧<br/>Carrier List] --> B[航空会社詳細<br/>Carrier Detail]
    B --> C[航空会社ロック管理<br/>Carrier Lock Management]
    
    A --> D[新規航空会社作成<br/>Create Carrier]
    B --> E[航空会社編集<br/>Edit Carrier]
```

### 6. 追加サービス管理 (/DMO/UI_SUPPLEMENT)

```mermaid
graph TD
    A[追加サービス一覧<br/>Supplement List] --> B[追加サービス詳細<br/>Supplement Detail]
    B --> C[追加サービステキスト<br/>Supplement Text]
    
    A --> D[新規追加サービス作成<br/>Create Supplement]
    B --> E[追加サービス編集<br/>Edit Supplement]
    
    subgraph "カテゴリ管理"
        CAT1[サービスカテゴリ<br/>Service Category]
        CAT2[カテゴリテキスト<br/>Category Text]
    end
    
    B --> CAT1
    B --> CAT2
```

## 画面要素詳細

### 共通UI要素

#### 1. リスト画面（Line Item）
- **表示項目**: ID、名前、ステータス、日付、金額
- **操作**: 検索、フィルタ、ソート、選択
- **アクション**: 新規作成、編集、削除

#### 2. 詳細画面（Object Page）
- **ファセット構成**:
  - 識別情報（Identification）
  - 関連エンティティ（LineItem Reference）
- **操作**: 編集、保存、キャンセル
- **アクション**: ビジネスアクション（承認、却下等）

#### 3. バリューヘルプ画面
- **目的**: 関連データの選択
- **機能**: 検索、フィルタ、選択
- **データ**: 代理店、顧客、航空会社、フライト等

### 画面遷移パターン

#### 1. 階層ナビゲーション
```
旅行 → 予約 → 追加サービス
```

#### 2. 関連エンティティナビゲーション
```
旅行 ↔ 代理店
旅行 ↔ 顧客
予約 ↔ 航空会社
予約 ↔ フライト
```

#### 3. アクションベースナビゲーション
```
リスト → 詳細 → アクション実行 → 結果表示
```

## 技術的な画面制御

### 1. 権限制御
- **認可チェック**: `@AccessControl.authorizationCheck: #NOT_REQUIRED`
- **フィールドレベル**: 読み取り専用、隠し項目

### 2. 検索機能
- **デフォルト検索**: `@Search.defaultSearchElement: true`
- **検索可能**: `@Search.searchable: true`

### 3. UI注釈
- **表示制御**: `@UI.hidden: true`
- **重要度**: `importance: #HIGH|#MEDIUM|#LOW`
- **配置**: `position: [数値]`

### 4. テキスト表示
- **テキスト要素**: `@ObjectModel.text.element`
- **テキスト配置**: `@UI.textArrangement: #TEXT_ONLY`
- **ローカライズ**: `localized`

## まとめ
このABAP Platform Flight Reference Scenarioは、以下の画面パターンを実装しています：

1. **マスターディテール**: 一覧から詳細への遷移
2. **階層ナビゲーション**: 親子関係のあるエンティティ間の遷移
3. **バリューヘルプ**: 関連データの選択画面
4. **アクション実行**: ビジネスロジックの実行画面
5. **ドラフト機能**: 一時保存機能付きの編集画面

これらの画面パターンは、現代的なSAP Fioriアプリケーションの標準的な構成を示しており、RAP（RESTful Application Programming）モデルの実装例として参考になります。